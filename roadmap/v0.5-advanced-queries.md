# v0.5: Advanced Queries

**Theme**: Richer query capabilities across all primitives.

v0.1 provides basic CRUD for each primitive. v0.5 adds query features that reduce the amount of work application code must do: pagination, filtering, path-based operations, and cross-primitive correlation.

## Features

### JSON Path Queries

Support RFC 6902 JSON Patch operations and path-based queries.

- WAL entry type `0x24` is reserved for JSON patch operations
- `JsonPath` type already exists in `crates/core/src/primitives/json.rs`
- Path parsing and traversal (`get_at_path`, `set_at_path`, `delete_at_path`) already implemented
- Add: patch application via WAL for efficient partial updates without full document replacement

### KV Range Scans with Pagination

Scan key ranges with cursor-based pagination.

- `KV::list()` currently returns all matching keys in one call
- Add: `limit` and `cursor` parameters for paginated iteration
- Add: reverse scan (descending key order)
- Important for large key spaces where listing everything is impractical

### Event Log Filtering

Filter events by time range and payload fields.

- Events currently support `read` (all) and `read_by_type` (by event type)
- Add: time range filtering (events between two timestamps)
- Add: payload field matching (events where `payload.field == value`)
- Events are append-only and ordered, so time-range queries can use binary search

### Cross-Primitive Search Correlation

Correlate search results across primitives.

- Hybrid search already merges results from multiple primitives via RRF
- Add: ability to join results (e.g., find KV entries referenced by matching events)
- Add: search result grouping by primitive type with per-group limits

### Aggregation Operations

Compute aggregates over query results.

- Add: `count`, `sum`, `avg`, `min`, `max` over KV/JSON/Event query results
- Computed server-side to avoid transferring full result sets
- Useful for analytics and monitoring queries

## Context

Richer queries reduce round-trips between the application and database. For AI agents, this means faster decision-making loops and simpler application code.

## Dependencies

- v0.4 (vector enhancements) for metadata filter infrastructure reuse
