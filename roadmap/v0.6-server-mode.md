# v0.6: Server Mode

**Theme**: Multi-process access via network protocol.

StrataDB is embedded-first, but many deployments need multiple processes to access the same database. v0.6 adds an optional server mode where one process hosts the database and others connect over TCP.

## Features

### TCP Server

Standalone server binary that wraps the embedded database.

- Tokio is already a workspace dependency
- The `Executor` + `Command`/`Output` architecture maps directly to request/response RPC
- Server binary: `stratadb-server --data-dir /path --port 9876`
- Graceful shutdown with WAL flush

### Wire Protocol

Binary protocol for command serialization over the network.

- `Command` and `Output` enums already derive `Serialize`/`Deserialize` via serde
- Define framing format: length-prefixed messages with version header
- Use MessagePack (rmp-serde already a workspace dependency) for compact binary encoding
- Protocol versioning for forward compatibility

### Rust Client Library

Client crate that provides the same `Strata` API over the network.

- New crate: `strata-client`
- Implements the same high-level API as the embedded `Strata` struct
- Application code switches between embedded and client mode by changing one line
- Connection pooling with automatic reconnection

### Session Management

Server-side session tracking for multi-step operations.

- `Session` type already exists in the executor for transaction state
- Map network connections to server-side sessions
- Session timeout and cleanup for abandoned connections

### Authentication

Basic access control for server mode.

- API key authentication (shared secret)
- Per-branch read/write permissions
- Optional -- server can run in open mode for development

## Context

Server mode expands StrataDB's deployment options without changing the core architecture. The existing `Command`/`Output` pattern makes this a natural extension -- the executor doesn't care whether commands arrive from in-process calls or network messages.

## Dependencies

- v0.3 (storage efficiency) -- server workloads need WAL compaction and retention
- v0.5 (advanced queries) -- network overhead makes rich server-side queries important
