# v0.2: Branch Operations

**Theme**: Complete the branch story.

Branches are StrataDB's core isolation primitive -- analogous to git branches. v0.1 shipped create, delete, list, and exists. v0.2 fills the gaps that make branches useful for real AI agent workflows: forking experiments, comparing results, and merging winners back.

## Features

### Branch Forking

Copy all data from one branch to a new branch. This is the foundation for A/B testing, experiment tracking, and safe exploration.

- Stub already exists: `crates/executor/src/api/branches.rs` (`fork()` returns `NotImplemented`)
- Must copy all 6 primitives (KV, Event, State, JSON, Vector, Branch metadata)
- Should be atomic -- either the fork succeeds completely or not at all
- The source branch remains unchanged

**API**: `db.branches().fork("source", "destination")`

### Branch Diffing

Compare two branches and return their differences. Essential for understanding what an experiment changed.

- Stub already exists: `crates/executor/src/api/branches.rs` (`diff()` returns `NotImplemented`)
- `BranchDiff` struct exists with `only_in_first`, `only_in_second`, `different` fields
- Engine already has `diff_views()` and `ReadOnlyView` infrastructure in `crates/engine/src/recovery/replay.rs`
- Should diff across all primitives, not just KV

**API**: `db.branches().diff("branch-a", "branch-b")`

### Branch Merge

Apply changes from one branch into another. Completes the fork-experiment-merge workflow.

- New feature -- no existing stub
- Must handle conflicts (same key modified in both branches)
- Conflict resolution strategy: last-writer-wins by default, with option to error on conflicts
- Depends on diffing infrastructure

**API**: `db.branches().merge("source", "target")`

### Branch Snapshots

Create a named point-in-time snapshot of a branch that can be restored later. Lightweight alternative to forking when you just want a save point.

- Snapshot infrastructure already exists in `crates/durability/src/disk_snapshot/`
- This extends it with user-facing named snapshots per branch
- Restore replays from snapshot, discarding changes made after the snapshot

**API**: `db.branches().snapshot("branch", "snapshot-name")` / `db.branches().restore("branch", "snapshot-name")`

## Context

Branch operations are the highest-priority gap because they directly enable the AI agent workflows StrataDB is designed for: running parallel experiments, comparing outcomes, and keeping the best result.

## Dependencies

None -- builds on v0.1 branch infrastructure.
